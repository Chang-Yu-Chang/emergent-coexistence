---
title: ""
author: "Chang-Yu Chang"
date: "`r Sys.Date()`" 
output: 
    bookdown::pdf_document2:
      toc: false
      number_sections: no
fontsize: 12pt
urlcolor: blue
linkcolor: red
header-includes: 
- \usepackage{float}
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  cache = FALSE, 
  echo = FALSE,
	fig.align = "center",
  fig.pos = "H",
	fig.height = 4,
	fig.width = 6)
library(tidyverse)
library(data.table)
library(invnet)
root <- rprojroot::is_r_package # Package root
```


Invasion network - random assembly

`r date = "20191216"; date`
`r n_plate = 2`

# SequalPrep PCR product cleanup and normalization

Input: duplicate PCR plates

Output: 20 uL 1.25 ng/uL DNA in PCR plate clean_normalized_PCR


Items                | Usage                             | Amount
---------------------|-----------------------------------|------------
PCR plate            | PCR_mix, unbound_DNA, chean_PCR   | `r n_plate * 3`
SequalPrep plate     | PCR cleanup and normalization     | `r n_plate`
SequalPrep binding buffer | binding                      | `r n_plate * 100 * 0.02` mL
SequalPrep wash buffer    | wash                         | `r n_plate * 100 * 0.05` mL 
SequalPrep elution buffer | elution                      | `r n_plate * 100 * 0.02` mL
20uL tip box         | dispense                          | `r n_plate * 4`
200uL tip box        | dispense                          | `r n_plate * 2`

Table: Materials.

- Thaw the `r n_plate * 2` PCR plates and spin down.
- Label `r n_plate * 3` PCR plates with the naming convention like **T0 C P2 PCR_mix**, **T0 C P2 unbound_DNA**, and **T0 C P2 chean_PCR**. Same for T3.
- Mix 20uL of each replicate PCR into each well of a skirted PCR plate PCR_mix (40 uL in total).
- Add 20uL SequalPrep Binding buffer to each well of SequalPrep plate.
- Add 20uL mixed PCR product into each well of SequalPrep plate.
- Cover with PCR lid, vortex 30 sec, and centrifuge briefly.
- Incubate for 1 hour at room temperature. Note: extra incubation time will not improve yield but will not decrease it either.  Overnight incubations are fine if necessary.
- Transfer unbound DNA to fresh skirted PCR plate unbound_DNA, being careful not to touch the sides of the wells. Discard or foil and save at -20C for up to 30 days and reuse for further SequalPrep.
- Add 50 uL SequalPrep Wash buffer to the SequalPrep plate containing bound DNA and pipet up and down twice to mix. Vortex.
- Remove buffer from wells by pipetting. Tap plate on paper towel gently to remove remaining buffer. Spin down the plate.
- To elute, add 20 uL SequalPrep Elution buffer to each well.
- Cover with lid, vortex 30 sec, and centrifuge briefly.
- Incubate at room temperature for 5 minutes.
- Elute DNA from each well into a new skirted PCR plate clean_normalized_PCR and store at -20C.

\newpage 

# Genewiz Sanger sequencing prep

Input: 20 uL normalized DNA 1.25 ng/uL in clean_normalized_PCR

Output: DNA with primer in a PCR plate for sequencing

Items                | Usage                             | Amount
---------------------|-----------------------------------|------------
PCR plate            | sequencing                        | `r n_plate`
27F 5uM primer       | CASEU primer                      | `r n_plate * 5 * 100 /1000` mL  
20uL tip box         | dispense                          | `r n_plate`

Table: Materials.


- Label `r n_plate` PCR plates with the naming convention **T0 C P2 seq** and **T3 C P2 seq**.
- Make `r n_plate * 5 * 100` uL 5uM 27F primer stock (`r n_plate * 5 * 100 * 0.05` uL 100 uM primer stock + `r n_plate * 5 * 100 * 0.95` uL ddH2O).
- Add **5 uL** of each primer to the PCR plate seq.
- Add **10 uL** of normalized DNA to each well of the PCR plate seq.
- For <48 samples, Label tubes with tube ID from Genewiz online ordering system, which will have your initials and sample number. Write these codes on the sides of tubes. Note: For >48 samples, arrange the samples vertically (in columns).
- Store the PCR seq plates in a box. 
- Drop off the box at Genewiz West Campus pickup location: ISTC room 366.


```{r eval = F}
data.frame(
  DNA = c("1-2ng/uL template DNA", "5uM 27F primer"),
  Volume = c(10, 5),
  FinalMass = c("20 ng", "12 pmol")
) %>%
  mutate(MasterVolume = Volume * 80) %>%
  setNames(c("DNA", "Volume (uL)", "Final Mass", "MasterVolume (uL)")) %>%
  knitr::kable()
```

```{r}
load(root$find_file("output/protocol/tab_fig/protocol_20191205_random_network_T2-plate_layout.Rdata"))
plates_DNA_list$DNA_C_P2
```


