---
title: "Simulation on self-assembled communities using mechanistic models"
author: "Chang-Yu Chang"
date: "`r Sys.Date()`"
output:
  html_notebook:
    number_sections: no
    toc: yes
linkcolor: red
fontsize: 12pt
urlcolor: blue
---

```{r setup, include = FALSE}
# Knitr options
knitr::opts_chunk$set(
  cache = TRUE, 
  echo = TRUE,
	fig.align = "center",
	fig.height = 4,
	fig.width = 6)
  #  engine.path = '~/anaconda3/bin/python3.7m')

# Packages
library(tidyverse)
library(data.table)
library(invnet)
library(reticulate) # Python interface
reticulate::use_python('~/anaconda3/bin/python3.7m')

# Local directory and functions
root <- rprojroot::is_r_package # Package root
source(root$find_file("misc/utils.R"))
source(root$find_file("misc/network_functions.R"))
write_all_csv <- TRUE
write_all_pdf <- TRUE

# Data
isolates <- fread(root$find_file("data/output/isolates.csv"))
pairs <- fread(root$find_file("data/output/pairs.csv"))
communities <- fread(root$find_file("data/temp/communities.csv"))
communities_name <- communities$Community
communities_size <- communities$CommunitySize
communities_name_pool <- c(paste0("C", 1:12, "Rpool"), paste0("C", rep(1:12, each = 8), "R", rep(1:8, 12)))
```

# Settings

## Import packages

```{python}
from IPython.display import Image
from community_simulator import *
from community_simulator.usertools import *
from community_simulator.visualization import *
import seaborn as sns
import matplotlib.pyplot as plt
from matplotlib.backends import backend_pdf as bpdf
colors = sns.color_palette()
#%matplotlib inline
```

## Load the functions

```{python}
exec(open("script/community_simulator-00A-simulation_algorithm.py").read()) # Single algorithm for simulation `simulate_community()`
exec(open("script/community_simulator-01-regional_pool.py").read())
exec(open("script/community_simulator-02-community_function.py").read())
exec(open("script/community_simulator-02A-community_function_student.py").read()) # Student submitted algorithms
exec(open("script/community_simulator-03-community_selection.py").read())
exec(open("script/community_simulator-03A-community_selection_student.py").read()) # Student submitted algorithms
exec(open("script/community_simulator-04-migration.py").read()) 
exec(open("script/community_simulator-04A-migration_student.py").read()) # Student submitted algorithms

```


