
Scripts for the experimental project on emergent coexistence

Preprint link: [Emergent coexistence in multispecies microbial communities](https://www.biorxiv.org/content/10.1101/2022.05.20.492860v1)

## Setup to repeat the analysis

### Step 1: clone this repository

Change the current working directory to the location where you want the cloned directory.

```
$ cd /directory/to/where/you/want/ # Directory to where you want
$ git clone https://github.com/Chang-Yu-Chang/emergent-coexistence
```

### Step3: install r environment dependency

This project is based on the lasted R `4.2.0`
```
> sessionInfo()
R version 4.2.0 (2022-04-22)
Platform: x86_64-apple-darwin17.0 (64-bit)
Running under: macOS Big Sur 11.5.2

Matrix products: default
LAPACK: /Library/Frameworks/R.framework/Versions/4.2/Resources/lib/libRlapack.dylib

locale:
[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8

attached base packages:
[1] stats     graphics  grDevices datasets  utils     methods   base     

loaded via a namespace (and not attached):
[1] compiler_4.2.0      BiocManager_1.30.18 tools_4.2.0         renv_0.15.5    
```

To install the dependent R packages, we use `renv` to record the packages used in this project. After cloning this repo into the local directory, open your code editor (e.g., Rstudio) and run the following two lines in R console. 

```
> install.packages("renv")
> renv::init(bioconductor = T)
```

This will automatically install all packages on which this project depends. It may takes a few minutes. The installed packages will not be stored in your global environment but instead remain project-specific (saved in the subdirectory `renv/library/`). When you open a new R session under the R project structure (the folder that contains `emergent-coexistence.Rproj`), for instance in R studio, these project-specific packages will be already installed. 


### Step 3: sync the raw data to Dropbox

Link to the raw data 

https://www.dropbox.com/sh/60rw7xmerown3vk/AACMzcZMR-DzF_5vG3KF0CG-a?dl=0

The data are currently stored in the directory `~/Dropbox/lab/emergent-coexistence/data/`, where the all scripts are written to read this absolute directory. For the following scripts to work, this directory has to be set up.


## Data

The data wrangling steps are conducted in order in four master Rmd along with associated R scripts in `output/report/script/`: 

- `output/report/01-isolates.Rmd`
- `output/report/02-pairs.Rmd`
- `output/report/03-networks.Rmd`
- `output/report/04-summary.Rmd`

A quick overview of these steps is reported in the generated notebooks `01-isolates.nb.html`, `02-pairs.nb.html`, `03-networks.nb.html`, and `04-summary.nb.html`. 

To generate all ready-for-figure data in `~/Dropbox/lab/emergent-coexistence/data/output/`, basically run all R scripts in `output/report/script/` in order, either by executing the code chunks in the four Rmd files, or using terminal commands saved in a master zsh.

```
$ cd output/report/script/
$ zsh run.zsh
```

## Figures

The figures and tables in `plots/` are generated by one R script `plotting_scripts/figures.R`











